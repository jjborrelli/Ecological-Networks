library(igraph)
library(NetIndices)
library(reshape2)
library(ggplot2)
library(devtools)
library(vegan)
url <- "https://raw.github.com/jjborrelli/Ecological-Networks/master/Food%20Webs/Rscripts/web_functions.R"
source_url(url)
### Import food web data  --------------------------------------------------
inputs <- get_webs("~/Dropbox/Food Web Database/Food_Web/Edgelist")
web.graphs <- inputs$graph.list
web.matrices <- inputs$adjacency.list
webnames <- inputs$webnames
### Set Working Directory     --------------------------------------------------
setwd("~/Desktop/GitHub/Ecological-Networks/Food Webs")
fw.indices <- read.csv("Tables/FWindices.csv")
node.props <- read.csv("Tables/NODEproperties.csv")
motif.df <- read.table("Tables/motifCOUNTS.csv", header = T, sep = ",")
read.csv("Tables/permutedCI_both.csv")
perm.both <- read.csv("Tables/permutedCI_both.csv")
perm.row <- read.csv("Tables/permutedCI_row.csv")
perm.col <- read.csv("Tables/permutedCI_col.csv")
perm.both
odds <- seq(1, 25, 2)
evens <- seq(2, 26, 2)
perm.both[,odds]
perm.both[odds, ]
plot(perm.both[odds, ])
plot(perm.both[odds, ]~1:13)
plot(1:13, perm.both[odds, ])
plot(1:13, perm.both[odds, 1])
perm.both[odds, 1]
plot(1:13, perm.both[odds, 2])
points(1:13, perm.both[evens, 2])
plot(1:13, perm.both[odds, 2], typ = "b")
points(1:13, perm.both[evens, 2], typ = "b")
motif.df
points(motif.df[1, 3:15], typ = "l")
plot(1:13, perm.both[odds, 2], typ = "b")
points(1:13, perm.both[evens, 2], typ = "b")
points(motif.df[1, 3:15], typ = "l", col = "blue")
points(1:13, motif.df[1, 3:15], typ = "l", col = "blue")
perm.both
perm.both <- read.csv("Tables/permutedCI_both.csv", header = T)
perm.both
motif.df
plot(motif.df[,3])
plot(motif.df[,3], col = "blue")
plot(motif.df[,3], col = "blue", typ = 24)
plot(motif.df[,3], col = "blue", pch = 24)
plot(motif.df[,3], col = "blue", pch = 20)
perm.both[1,]
points(perm.both[1,2:51], pch = 21, col = "red")
plot(1:50, motif.df[,3], col = "blue", pch = 20)
points(1:50, perm.both[1,2:51], pch = 21, col = "red")
plot(1:50, motif.df[,3], col = "blue", pch = 20)
points(1:50, perm.both[1,2:51], typ = "l", col = "red")
points(1:50, perm.both[2,2:51], typ = "l", col = "red")
plot(1:50, mean(motif.df[,3]), col = "blue", pch = 20)
plot(mean(motif.df[,3]), col = "blue", pch = 20)
points(mean(perm.both[1,2:51]), typ = "l", col = "red")
perm.both[1,2:51]
points(mean(as.numeric(perm.both[1,2:51])), typ = "l", col = "red")
mean(as.numeric(perm.both[1,2:51]))
points(mean(as.numeric(perm.both[1,2:51])), col = "red")
points(mean(as.numeric(perm.both[2,2:51])), col = "red")
motif.df
mots <- motif.df[,3:15]
mots
motmeans <- colMeans(mots)
motmeans
plot(motmeans, col = "blue", pch = 20)
perm.both
rowMeans(perm.both[,2:50])
odds <- seq(1, 25, 2)
evens <- seq(2, 26, 2)
both.means <- rowMeans(perm.both[,2:50])
both.means.low <- rowMeans(perm.both[evens, 2:50])
both.means.high <- rowMeans(perm.both[odds, 2:50])
points(both.means.low, col = "red")
points(both.means.high, col = "red")
plot(1:13, motmeans, col = "blue", pch = 20)
plot(seq(1,13), motmeans, col = "blue", pch = 20)
plot(x = 1:13, motmeans, col = "blue", pch = 20)
plot(1:13, motmeans, col = "blue", pch = 20)
odds <- seq(1, 25, 2)
evens <- seq(2, 26, 2)
both.means.low <- rowMeans(perm.both[evens, 2:50])
both.means.high <- rowMeans(perm.both[odds, 2:50])
points(both.means.low, col = "red", pch = 16)
points(both.means.high, col = "red", pch = 16)
plot(1:13, motmeans, col = "blue", pch = 20, xlim = c(0, 7500))
plot(1:13, motmeans, col = "blue", pch = 20, ylim = c(0, 7500))
plot(1:13, motmeans, col = "blue", pch = 20, ylim = c(0, 8000))
points(both.means.low, col = "red", pch = 16)
points(both.means.high, col = "red", pch = 16)
points(both.means.low, col = "red", pch = 16, typ = "o", lty = 2)
points(both.means.high, col = "red", pch = 16, typ = "o", lty = 2)
points(1:13, motmeans, col = "blue", pch = 20, ylim = c(0, 8000))
system.time(
permutes.col <- web_permutation(web.matrices, fixedmar = "columns", times = 1000)
)
permutes.col
boxplot(permutes.col[[1]])
boxplot(permutes.col[[1]], xlim = c(0, 1000))
boxplot(permutes.col[[1]], ylim = c(0, 1000))
boxplot(permutes.col[[1]], ylim = c(0, 1500))
points(motif.df[1,3:15])
boxplot(permutes.col[[1]][2:14], ylim = c(0, 1500))
points(motif.df[1,3:15])
motif.df[1,3:15]
points(as.numeric(motif.df[1,3:15]))
points(as.numeric(motif.df[1,3:15]), pch = 16, col = "blue")
boxplot(permutes.col[[1]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[1,3:15]), pch = 16, col = "blue")
permutes.col[[1]][2:14]
boxplot(permutes.col[[2]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[2,3:15]), pch = 16, col = "blue")
boxplot(permutes.col[[2]][2:14], ylim = c(0, 1500))
boxplot(permutes.col[[3]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[3,3:15]), pch = 16, col = "blue")
points(as.numeric(motif.df[4,3:15]), pch = 16, col = "blue")
boxplot(permutes.col[[4]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[4,3:15]), pch = 16, col = "blue")
motif.df
par(mfrow = c(5,2))
for(i in 1:10){
boxplot(permutes.col[[i]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[i,3:15]), pch = 16, col = "blue")
}
par(mfrow = c(5,2))
for(i in 1:10){
boxplot(permutes.col[[i]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[i,3:15]), pch = 16, col = "blue")
}
par(mfrow = c(4,2))
for(i in 1:8){
boxplot(permutes.col[[i]][2:14], ylim = c(0, 1500))
points(as.numeric(motif.df[i,3:15]), pch = 16, col = "blue")
}
par(mfrow = c(4,2), mar = c(.1, .1, .1, .1))
for(i in 1:8){
boxplot(permutes.col[[i]][2:14], ylim = c(0, 1500), main = NA, xlab = NA, ylab = NA)
points(as.numeric(motif.df[i,3:15]), pch = 16, col = "blue")
}
